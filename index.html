<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Multi-Frequency Radio</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    .freq-container { margin-bottom: 1.5rem; }
    .freq-title { font-weight: bold; }
    .freq-message { font-size: 1.5rem; margin-top: 0.3rem; }
  </style>
</head>
<body>
    <h1>Multi-Frequency Radio (3s ticks)</h1>
    <input type="number" placeholder="Frequency here..." id="freqIn" /><button onclick="setFreq()">Enter</button><br>
    <p id="data"></p>

    <script>
        const display = document.getElementById('data');
        const freqInput = document.getElementById('freqIn');

        function setFreq() {
            freq = Number(freqInput.value);
        }

        function createGibberish(len) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            let result = '';
            for (let i = 0; i < len; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        let data = null;
        let freq = 1000;
        let prevFreq = 1000;
        let delay = 3000;
        
        function tick() {
            if (prevFreq !== freq) {
                fetch(`freq${freq}.json`)
                    .then(res => res.json())
                    .then(d => {
                        data = d;
                    })
                    .catch(err => {
                        data = null;
                    });
            }

            if (!Array.isArray(data)) {
                display.textContent = createGibberish(50);
                delay = 20;
            } else {
                delay = 3000;
                const now = Date.now();
                const idx = Math.floor(now / delay);
                display.textContent = data[idx % data.length];
            }

            prevFreq = freq;

            setTimeout(tick, delay);
        }

        tick();
    </script>
</body>
</html>